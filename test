from concurrent.futures import ThreadPoolExecutor, as_completed
from tqdm import tqdm

gpickle = createGpicklefile()

with ThreadPoolExecutor(max_workers=10) as executor:
    futures = [
        executor.submit(process_chunk, idx, chunk, gpickle)
        for idx, chunk in enumerate(chunks_data)
    ]

    for future in tqdm(as_completed(futures), total=len(chunks_data), desc="triple processing"):
        idx, result = future.result()
        if result:
            chunks_data[idx] = result
