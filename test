import json
import os

def secrets_to_json(secret_file_path, output_json_path=None):
    """
    Convert a key=value style secrets file (no extension) to JSON.
    Example line format:
        KEY=value
        # comment line (ignored)
    """
    secrets = {}
    
    with open(secret_file_path, 'r') as f:
        for line in f:
            line = line.strip()
            # Skip blank or comment lines
            if not line or line.startswith('#'):
                continue
            
            # Split only on first '='
            if '=' in line:
                key, value = line.split('=', 1)
                secrets[key.strip()] = value.strip()
    
    # Default JSON output path if not provided
    if not output_json_path:
        output_json_path = os.path.splitext(secret_file_path)[0] + '.json'
    
    with open(output_json_path, 'w') as out:
        json.dump(secrets, out, indent=4)
    
    print(f"✅ Converted '{secret_file_path}' → '{output_json_path}'")

# Example usage
secrets_to_json("secrets")   # file has no extension
