def _delete_content_after_paragraph(paragraph, stop_on_heading=True):
    """
    Delete all content after the given paragraph — including tables —
    until the next heading (if stop_on_heading=True)
    """
    current = paragraph._p
    while True:
        next_elem = current.getnext()
        if next_elem is None:
            break

        # Stop if next paragraph is a styled heading
        if stop_on_heading and next_elem.tag == qn("w:p"):
            next_para = Paragraph(next_elem, paragraph._parent)
            if _is_heading_style(next_para):
                break

        # Remove any paragraph, table, or block-level content
        current.getparent().remove(next_elem)
