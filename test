import torch
from alibi_detect.cd.pytorch import KSDrift

# Convert to tensors
X_ref_tensor = torch.tensor(X_ref_tfidf, dtype=torch.float32)
X_test_tensor = torch.tensor(X_test_tfidf, dtype=torch.float32)

# Initialize KSDrift
cd = KSDrift(X_ref_tensor, p_val=0.05)

# Predict drift
preds = cd.predict(X_test_tensor)

# Results
is_drift = preds['data']['is_drift']
p_vals = preds['data']['p_val']
print(f"Drift detected: {is_drift}")
print(f"P-values: {p_vals}")
