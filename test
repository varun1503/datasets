# main.py

import os
from utils.kafka_producer import KafkaProducerUtils

# Sample config, secrets, and environment variables
config = {
    "BOOTSTRAP_SERVER": "localhost:9092",
    "KAFKA_CONFIG_PATH": "/path/to/kafka/config",
    "EMBEDDING_TOPIC_NAME": "sample-topic"
}

secrets = {
    "SSL_PASSWORD": "your_ssl_password"
}

env = {
    "BOOTSTRAP_SERVER": config["BOOTSTRAP_SERVER"],
    "KAFKA_CONFIG_PATH": config["KAFKA_CONFIG_PATH"],
    "EMBEDDING_TOPIC_NAME": config["EMBEDDING_TOPIC_NAME"]
}

# Initialize the Kafka producer
producer_util = KafkaProducerUtils(config, secrets, env)

# Publish a test message
message = {"text": "Hello Kafka!"}
producer_util.publish_message(message)

# Close connection
producer_util.close_kafka_connection()
