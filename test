import uuid

def insert_dynamic_clusters(keyspace, table, cluster_triple_final, host='127.0.0.1', username=None, password=None):
    from cassandra.cluster import Cluster
    from cassandra.auth import PlainTextAuthProvider

    auth = PlainTextAuthProvider(username, password) if username else None
    cluster = Cluster([host], auth_provider=auth) if auth else Cluster([host])
    session = cluster.connect()
    session.set_keyspace(keyspace)

    # Convert list of clusters to a map
    cluster_map = {f"cluster{i+1}": cluster for i, cluster in enumerate(cluster_triple_final)}

    insert_query = f"""
    INSERT INTO {table} (id, clusters)
    VALUES (%s, %s)
    """
    session.execute(insert_query, (uuid.uuid4(), cluster_map))

    session.shutdown()
    cluster.shutdown()
    print("Dynamic cluster data inserted.")
