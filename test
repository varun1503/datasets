rom sklearn.manifold import TSNE

# Apply t-SNE to reduce dimensions to 2
tsne = TSNE(n_components=2, random_state=42, perplexity=30)
reduced_embeddings_tsne = tsne.fit_transform(embeddings)

# Convert to DataFrame for easy plotting
df_tsne = pd.DataFrame(reduced_embeddings_tsne, columns=['TSNE1', 'TSNE2'])
df_tsne['label'] = labels

# Plot t-SNE results
plt.figure(figsize=(8, 6))
sns.scatterplot(data=df_tsne, x='TSNE1', y='TSNE2', hue='label', palette={'A': 'blue', 'B': 'orange'}, s=100)
plt.title('Feature Distribution of BERT Embeddings (Datasets A and B) - t-SNE')
plt.xlabel('t-SNE Dimension 1')
plt.ylabel('t-SNE Dimension 2')
plt.legend(title='Dataset')
plt.show()
