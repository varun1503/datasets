from langchain.schema import Document

final_chunk = []

for i in range(len(chunks_data)):
    chunk = chunks_data[i]

    # Safety check
    if not isinstance(chunk, dict):
        print(f"Skipping index {i}: not a dict ->", type(chunk))
        continue

    if "metadata" not in chunk:
        chunk["metadata"] = {}

    # Add quadruples to metadata
    chunk["metadata"]["quadruples"] = chunk["quadruples"]

    # Create LangChain Document
    doc = Document(
        page_content=chunk["content"],
        metadata=chunk["metadata"]
    )

    final_chunk.append((doc, 0.1))
