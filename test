def create_cluster_columns_table(keyspace, table, cluster_names, host='127.0.0.1', username=None, password=None):
    from cassandra.cluster import Cluster
    from cassandra.auth import PlainTextAuthProvider

    auth = PlainTextAuthProvider(username, password) if username else None
    cluster = Cluster([host], auth_provider=auth) if auth else Cluster([host])
    session = cluster.connect()
    session.set_keyspace(keyspace)

    # Build dynamic columns
    cluster_columns = ",\n".join([f"{name} list<text>" for name in cluster_names])
    
    query = f"""
    CREATE TABLE IF NOT EXISTS {table} (
        id UUID PRIMARY KEY,
        file_name text,
        {cluster_columns}
    );
    """
    
    session.execute(query)
    session.shutdown()
    cluster.shutdown()
    print(f"Table '{table}' with dynamic cluster columns created.")
