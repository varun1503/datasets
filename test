from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH

def add_title_to_top(doc: Document, title_text="Validation Report (Template)"):
    # Insert a paragraph at the very beginning
    p = doc.paragraphs[0].insert_paragraph_before() if doc.paragraphs else doc.add_paragraph()
    r = p.add_run(title_text)
    r.bold = True
    r.font.size = Pt(16)
    p.alignment = WD_ALIGN_PARAGRAPH.CENTER

    # Add spacing below title
    doc.add_paragraph()

    return doc

# Usage:
prepend_docx_path = "prepend.docx"
doc = Document(prepend_docx_path) if prepend_docx_path else Document()

# Always put the title at the very top
doc = add_title_to_top(doc)

# Continue your logic...
doc.add_paragraph(f"Model: {model} | Impact: {impact}{(' | Scope: ' + scope) if scope else ''}")
doc.add_page_break()
