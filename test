def parse_table_with_merged_cells(table):
    table_data = []
    max_cols = max(len(row.cells) for row in table.rows)

    for row in table.rows:
        row_data = []
        for cell in row.cells:
            # Get clean cell text
            cell_text = ' '.join(paragraph.text.strip() for paragraph in cell.paragraphs if paragraph.text.strip())
            row_data.append(cell_text or "")  # Keep empty if possibly merged
        # Pad row to match longest if needed
        while len(row_data) < max_cols:
            row_data.append("")  # Fill missing cells from merged cells
        table_data.append(row_data)
    return table_data
