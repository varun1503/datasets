from cassandra.cluster import Cluster

class KeyspaceAlreadyExistsError(Exception):
    pass

def raise_if_keyspace_exists(cluster_nodes, keyspace):
    cluster = Cluster(cluster_nodes)
    session = cluster.connect()

    keyspaces = session.execute("SELECT keyspace_name FROM system_schema.keyspaces;")
    keyspace_names = [row.keyspace_name for row in keyspaces]

    session.shutdown()
    cluster.shutdown()

    if keyspace in keyspace_names:
        raise KeyspaceAlreadyExistsError(f"Keyspace '{keyspace}' already exists.")
