import re
from sklearn.feature_extraction.text import ENGLISH_STOP_WORDS

# Example datasets a and b
data_a = ["This is a sentence from dataset A.", "Another example from dataset A."]
data_b = ["This is a sentence from dataset B.", "Another example from dataset B."]

# Function to preprocess text: lowercasing, tokenizing, and removing stopwords
def preprocess(text):
    text = text.lower()  # Convert to lowercase
    words = re.findall(r'\b\w+\b', text)  # Tokenize by word boundaries
    words = [word for word in words if word not in ENGLISH_STOP_WORDS]  # Remove stopwords
    return set(words)

# Get vocab sets for both datasets
vocab_a = set()
vocab_b = set()

for text in data_a:
    vocab_a.update(preprocess(text))

for text in data_b:
    vocab_b.update(preprocess(text))

# Calculate the Jaccard Index
intersection = len(vocab_a.intersection(vocab_b))
union = len(vocab_a.union(vocab_b))

jaccard_index = intersection / union

# Print the results
print(f"Vocabulary A: {vocab_a}")
print(f"Vocabulary B: {vocab_b}")
print(f"Jaccard Index: {jaccard_index:.4f}")

# Low Jaccard index indicates potential drift (low overlap of vocabulary)
if jaccard_index < 0.5:
    print("Potential drift detected! The datasets have a low overlap in vocabulary.")
else:
    print("No significant drift detected. The datasets have a reasonable overlap in vocabulary.")
