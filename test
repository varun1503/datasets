from cassandra.cluster import Cluster

def view_table_data(keyspace_name, table_name, host='127.0.0.1', limit=100):
    """
    Retrieves and prints data from a given Cassandra table.

    Args:
        keyspace_name (str): The keyspace name.
        table_name (str): The table name.
        host (str): Cassandra host IP (default is localhost).
        limit (int): Max number of rows to fetch (default is 100).
    """
    try:
        # Connect to the Cassandra cluster
        cluster = Cluster([host])
        session = cluster.connect()
        session.set_keyspace(keyspace_name)

        # Run query
        query = f"SELECT * FROM {table_name} LIMIT {limit};"
        rows = session.execute(query)

        # Print fetched rows
        print(f"\nData from {keyspace_name}.{table_name}:\n")
        for row in rows:
            print(row)

        # Clean up
        session.shutdown()
        cluster.shutdown()

    except Exception as e:
        print(f"Error retrieving data: {e}")
