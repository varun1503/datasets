import pandas as pd

# Load the main dataset
main_df = pd.read_excel("main_data.xlsx")

# Ensure we have at least 200 rows
if len(main_df) < 200:
    raise ValueError("Not enough rows in main_data.xlsx. At least 200 required.")

# Randomly sample 100 rows for reference data
reference_df = main_df.sample(n=100, random_state=42)

# Select another 100 rows that are not in reference data
current_df = main_df.drop(reference_df.index).sample(n=100, random_state=42)

# Save to new Excel files
reference_df.to_excel("reference_data.xlsx", index=False)
current_df.to_excel("current_data.xlsx", index=False)

print("Files saved successfully.")
