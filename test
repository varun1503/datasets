from cassandra.cluster import Cluster
from cassandra.auth import PlainTextAuthProvider

def create_simplified_triplet_table(keyspace, table_name="triplet_store", host='127.0.0.1', username=None, password=None):
    auth = PlainTextAuthProvider(username, password) if username else None
    cluster = Cluster([host], auth_provider=auth) if auth else Cluster([host])
    session = cluster.connect()
    session.set_keyspace(keyspace)

    create_query = f"""
    CREATE TABLE IF NOT EXISTS {table_name} (
        row_id timeuuid,
        subject text,
        predicate text,
        object text,
        creat_ts timestamp,
        mtda_val_tx map<text, text>,
        use_case_id int,
        use_case_nm text,
        vector vector<float, 1024>,
        PRIMARY KEY (row_id)
    );
    """

    session.execute(create_query)
    session.shutdown()
    cluster.shutdown()
    print(f"Simplified table '{table_name}' created successfully in keyspace '{keyspace}'.")
