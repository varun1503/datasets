def extract_mcp_text(result):
    """
    Safely extract text from MCP/FastMCP tool results.
    """
    if result is None:
        return None

    # Case 1: already a string
    if isinstance(result, str):
        return result

    # Case 2: list of content blocks
    if isinstance(result, list) and len(result) > 0:
        first = result[0]

        # TextContent-like object
        if hasattr(first, "text"):
            return first.text

        # dict-like
        if isinstance(first, dict) and "text" in first:
            return first["text"]

    # Fallback
    return str(result)
