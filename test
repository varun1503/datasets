def create_dynamic_cluster_table(keyspace, table, host='127.0.0.1', username=None, password=None):
    from cassandra.cluster import Cluster
    from cassandra.auth import PlainTextAuthProvider

    auth = PlainTextAuthProvider(username, password) if username else None
    cluster = Cluster([host], auth_provider=auth) if auth else Cluster([host])
    session = cluster.connect()
    session.set_keyspace(keyspace)

    query = f"""
    CREATE TABLE IF NOT EXISTS {table} (
        id UUID PRIMARY KEY,
        clusters map<text, list<text>>
    );
    """
    session.execute(query)
    session.shutdown()
    cluster.shutdown()
    print(f"Dynamic cluster table '{table}' created.")
