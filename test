from docx import Document
import os

def extract_docx_content(file_path, save_images=False, image_output_dir='images'):
    doc = Document(file_path)

    # Extract paragraphs
    paragraphs = [p.text.strip() for p in doc.paragraphs if p.text.strip()]

    # Extract tables
    tables = []
    for table in doc.tables:
        table_data = []
        for row in table.rows:
            row_data = [cell.text.strip() for cell in row.cells]
            table_data.append(row_data)
        tables.append(table_data)

    # Extract image labels (and optionally save them)
    images = []
    if save_images and not os.path.exists(image_output_dir):
        os.makedirs(image_output_dir)

    image_count = 0
    for rel in doc.part._rels.values():
        if "image" in rel.target_ref:
            image_count += 1
            label = f"Image_{image_count}"
            images.append(label)

            if save_images:
                ext = rel.target_ref.split('.')[-1]
                image_data = rel.target_part.blob
                filename = os.path.join(image_output_dir, f"{label}.{ext}")
                with open(filename, "wb") as f:
                    f.write(image_data)

    return paragraphs, tables, images

file_path = 'your_file.docx'
paragraphs, tables, images = extract_docx_content(file_path, save_images=True)

print("📄 Paragraphs:")
for p in paragraphs:
    print(" -", p)

print("\n📊 Tables:")
for idx, table in enumerate(tables, 1):
    print(f" Table {idx}:")
    for row in table:
        print("   ", row)

print("\n🖼️ Images:")
for img in images:
    print(" -", img)
