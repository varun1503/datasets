from docx import Document
import re

def renumber_captions(doc_path, output_path):
    """
    Renumber all table and figure captions sequentially
    """
    doc = Document(doc_path)
    
    # Update all existing table captions
    table_num = 1
    for para in doc.paragraphs:
        if re.search(r'\bTable\s+[\d.]+', para.text, re.IGNORECASE):
            para.text = re.sub(
                r'\bTable\s+[\d.]+',
                f'Table {table_num}',
                para.text,
                flags=re.IGNORECASE
            )
            table_num += 1
    
    # Update all existing figure captions
    figure_num = 1
    for para in doc.paragraphs:
        if re.search(r'\bFigure\s+[\d.]+', para.text, re.IGNORECASE):
            para.text = re.sub(
                r'\bFigure\s+[\d.]+',
                f'Figure {figure_num}',
                para.text,
                flags=re.IGNORECASE
            )
            figure_num += 1
    
    doc.save(output_path)
    print(f"✓ Captions renumbered successfully!")
    print(f"✓ Tables: {table_num - 1}")
    print(f"✓ Figures: {figure_num - 1}")
    print(f"✓ Saved to: {output_path}")

# Usage
input_file = "buisness.docx"
output_file = "buisness_renumbered.docx"

renumber_captions(input_file, output_file)
