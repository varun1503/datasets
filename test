def ensure_index_created(session, keyspace, table, index_name):
    index_check_query = f"""
    SELECT index_name FROM system_schema.indexes
    WHERE keyspace_name = '{keyspace}' AND table_name = '{table}';
    """
    rows = session.execute(index_check_query)
    existing_indexes = [row.index_name for row in rows]

    if index_name not in existing_indexes:
        raise RuntimeError(f"Index '{index_name}' was not created successfully.")
