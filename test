import pandas as pd
from sklearn.model_selection import train_test_split

def divide_data_equal_distribution(excel_path, sample_size=200, reference_ratio=0.8):
    # Load data
    df = pd.read_excel(excel_path)

    # Split into reference and current datasets
    reference_data, current_data = train_test_split(df, test_size=1-reference_ratio, stratify=df['label'])

    # Function to sample equal distribution of labels
    def sample_equal_distribution(data, sample_size):
        sampled_data = data.groupby('label').apply(lambda x: x.sample(min(len(x), sample_size // len(data['label'].unique()))))
        return sampled_data.sample(n=sample_size, random_state=42)

    # Sample 200 points at a time for reference data
    reference_sampled = sample_equal_distribution(reference_data, sample_size)

    return reference_sampled, current_data

# Example usage
reference_sampled, current_data = divide_data_equal_distribution('your_data.xlsx', sample_size=200)

# The resulting `reference_sampled` will have 200 points with equal label distribution.
